<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Mapper: src/libocad/file.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="openorienteering.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mapper
   &#160;<span id="projectnumber">0.7.0</span>
   </div>
   <div id="projectbrief">API documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4cfd1ffdf2fee63e52053c509bce50ff.html">libocad</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">file.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<h3 class="version">(<a href="https://github.com/OpenOrienteering/mapper/blob/b51adba/src/libocad/file.c"><tt>b51adba</tt></a> on 22 Nov 2014)</h3><div class="textblock"><code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &quot;<a class="el" href="libocad_8h.html">libocad.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for file.c:</div>
<div class="dyncontent">
<div class="center"><img src="file_8c__incl.png" border="0" usemap="#src_2libocad_2file_8c" alt=""/></div>
<map name="src_2libocad_2file_8c" id="src_2libocad_2file_8c">
<area shape="rect" id="node9" href="libocad_8h.html" title="libocad.h" alt="" coords="608,80,683,107"/>
<area shape="rect" id="node10" href="types_8h.html" title="types.h" alt="" coords="613,229,678,256"/>
<area shape="rect" id="node12" href="array_8h.html" title="array.h" alt="" coords="614,155,677,181"/>
<area shape="rect" id="node13" href="geometry_8h.html" title="geometry.h" alt="" coords="701,155,787,181"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__IndexBuilder.html">_IndexBuilder</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for compacting entity indexes - used in the compaction callback functions.  <a href="struct__IndexBuilder.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__ocad__file__bounds__data.html">_ocad_file_bounds_data</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a08cb40fff943b436f6842494af05274e"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__IndexBuilder.html">_IndexBuilder</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#a08cb40fff943b436f6842494af05274e">IndexBuilder</a></td></tr>
<tr class="memdesc:a08cb40fff943b436f6842494af05274e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for compacting entity indexes - used in the compaction callback functions.  <a href="#a08cb40fff943b436f6842494af05274e">More...</a><br /></td></tr>
<tr class="separator:a08cb40fff943b436f6842494af05274e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af37ebdb1f5b9bfe5128eae9d6622f212"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__ocad__file__bounds__data.html">_ocad_file_bounds_data</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#af37ebdb1f5b9bfe5128eae9d6622f212">ocad_file_bounds_data</a></td></tr>
<tr class="separator:af37ebdb1f5b9bfe5128eae9d6622f212"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aeaf1a64097132d2ec2749c3bfe15facf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#aeaf1a64097132d2ec2749c3bfe15facf">ocad_init</a> ()</td></tr>
<tr class="memdesc:aeaf1a64097132d2ec2749c3bfe15facf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the libocad library.  <a href="#aeaf1a64097132d2ec2749c3bfe15facf">More...</a><br /></td></tr>
<tr class="separator:aeaf1a64097132d2ec2749c3bfe15facf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8af709aad4f892f16448b6bbc334f90b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#a8af709aad4f892f16448b6bbc334f90b">ocad_shutdown</a> ()</td></tr>
<tr class="memdesc:a8af709aad4f892f16448b6bbc334f90b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shuts down the libocad library.  <a href="#a8af709aad4f892f16448b6bbc334f90b">More...</a><br /></td></tr>
<tr class="separator:a8af709aad4f892f16448b6bbc334f90b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4c558719d952c795689926f1899a558"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#aa4c558719d952c795689926f1899a558">ocad_file_open</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> **pfile, const char *filename)</td></tr>
<tr class="memdesc:aa4c558719d952c795689926f1899a558"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens a file with the given filename.  <a href="#aa4c558719d952c795689926f1899a558">More...</a><br /></td></tr>
<tr class="separator:aa4c558719d952c795689926f1899a558"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18982d6416484fe638b1a8031fc688c6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#a18982d6416484fe638b1a8031fc688c6">ocad_file_open_mapped</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> **pfile, const char *filename)</td></tr>
<tr class="memdesc:a18982d6416484fe638b1a8031fc688c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Behaves exactly like <a class="el" href="libocad_8h.html#aa4c558719d952c795689926f1899a558" title="Opens a file with the given filename. ">ocad_file_open()</a>, except that the system attempts to open the file via memory mapping.  <a href="#a18982d6416484fe638b1a8031fc688c6">More...</a><br /></td></tr>
<tr class="separator:a18982d6416484fe638b1a8031fc688c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5119d89e1bfc80481f230c28404b1cfb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#a5119d89e1bfc80481f230c28404b1cfb">ocad_file_open_memory</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> **pfile, <a class="el" href="types_8h.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> *buffer, <a class="el" href="types_8h.html#afaa62991928fb9fb18ff0db62a040aba">u32</a> size)</td></tr>
<tr class="memdesc:a5119d89e1bfc80481f230c28404b1cfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Behaves exactly like <a class="el" href="libocad_8h.html#aa4c558719d952c795689926f1899a558" title="Opens a file with the given filename. ">ocad_file_open()</a>, except that the given buffer must contain the map data.  <a href="#a5119d89e1bfc80481f230c28404b1cfb">More...</a><br /></td></tr>
<tr class="separator:a5119d89e1bfc80481f230c28404b1cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac595fc716c3c92481ac5ee141a619514"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#ac595fc716c3c92481ac5ee141a619514">ocad_file_close</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *pfile)</td></tr>
<tr class="memdesc:ac595fc716c3c92481ac5ee141a619514"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes an open OCADFile.  <a href="#ac595fc716c3c92481ac5ee141a619514">More...</a><br /></td></tr>
<tr class="separator:ac595fc716c3c92481ac5ee141a619514"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab25f310ecd5f163207b8c38ee0e57c5d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#ab25f310ecd5f163207b8c38ee0e57c5d">ocad_file_save</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *pfile)</td></tr>
<tr class="separator:ab25f310ecd5f163207b8c38ee0e57c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a084c469f3329a23234299a9422190a26"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#a084c469f3329a23234299a9422190a26">ocad_file_save_as</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *pfile, const char *filename)</td></tr>
<tr class="memdesc:a084c469f3329a23234299a9422190a26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves an open OCADFile to the given filename.  <a href="#a084c469f3329a23234299a9422190a26">More...</a><br /></td></tr>
<tr class="separator:a084c469f3329a23234299a9422190a26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a5831e0bcdc545ba99487e3728dab2e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#a2a5831e0bcdc545ba99487e3728dab2e">ocad_file_new</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> **pfile)</td></tr>
<tr class="memdesc:a2a5831e0bcdc545ba99487e3728dab2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new OCADFile struct in memory.  <a href="#a2a5831e0bcdc545ba99487e3728dab2e">More...</a><br /></td></tr>
<tr class="separator:a2a5831e0bcdc545ba99487e3728dab2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae48115c9b43398bd185434a841629888"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#ae48115c9b43398bd185434a841629888">ocad_file_reserve</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *file, int amount)</td></tr>
<tr class="memdesc:ae48115c9b43398bd185434a841629888"><td class="mdescLeft">&#160;</td><td class="mdescRight">Makes sure that 'amount' number of bytes are reserved in the file's buffer in addition to the already used space.  <a href="#ae48115c9b43398bd185434a841629888">More...</a><br /></td></tr>
<tr class="separator:ae48115c9b43398bd185434a841629888"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60bdb2ad0297bb2abf4679d3d6438fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#ae60bdb2ad0297bb2abf4679d3d6438fa">ocad_file_compact</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *pfile)</td></tr>
<tr class="memdesc:ae60bdb2ad0297bb2abf4679d3d6438fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optimizes and repairs an open OCADFile.  <a href="#ae60bdb2ad0297bb2abf4679d3d6438fa">More...</a><br /></td></tr>
<tr class="separator:ae60bdb2ad0297bb2abf4679d3d6438fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7042bcca772f374f770c9d58f344013"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#ab7042bcca772f374f770c9d58f344013">ocad_export</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *pfile, void *opts)</td></tr>
<tr class="memdesc:ab7042bcca772f374f770c9d58f344013"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exports part or all of an OCAD file to a specific format.  <a href="#ab7042bcca772f374f770c9d58f344013">More...</a><br /></td></tr>
<tr class="separator:ab7042bcca772f374f770c9d58f344013"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c312522ebca751f4df96f3b77a3e9dc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#a1c312522ebca751f4df96f3b77a3e9dc">ocad_export_file</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *pfile, const char *filename, void *opts)</td></tr>
<tr class="memdesc:a1c312522ebca751f4df96f3b77a3e9dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exports part or all of an OCAD file to a specific file.  <a href="#a1c312522ebca751f4df96f3b77a3e9dc">More...</a><br /></td></tr>
<tr class="separator:a1c312522ebca751f4df96f3b77a3e9dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeca06cf2ff5c7888932c6fa325c53f40"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#a0ecf26b576b9a54eca656b9be7ba6a06">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="file_8c.html#aeca06cf2ff5c7888932c6fa325c53f40">ocad_file_bounds</a> (<a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *file, OCADRect *rect)</td></tr>
<tr class="memdesc:aeca06cf2ff5c7888932c6fa325c53f40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the bounding rectangle of all objects in the file.  <a href="#aeca06cf2ff5c7888932c6fa325c53f40">More...</a><br /></td></tr>
<tr class="separator:aeca06cf2ff5c7888932c6fa325c53f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a08cb40fff943b436f6842494af05274e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__IndexBuilder.html">_IndexBuilder</a>  <a class="el" href="file_8c.html#a08cb40fff943b436f6842494af05274e">IndexBuilder</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Structure for compacting entity indexes - used in the compaction callback functions. </p>

</div>
</div>
<a class="anchor" id="af37ebdb1f5b9bfe5128eae9d6622f212"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__ocad__file__bounds__data.html">_ocad_file_bounds_data</a>  <a class="el" href="file_8c.html#af37ebdb1f5b9bfe5128eae9d6622f212">ocad_file_bounds_data</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab7042bcca772f374f770c9d58f344013"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_export </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *&#160;</td>
          <td class="paramname"><em>pfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exports part or all of an OCAD file to a specific format. </p>
<p>The output stream must be preset in the options structure. You can use <a class="el" href="libocad_8h.html#a9ccb8fc555deb5f28b1f2a555c7aeeb8" title="Exports part or all of an OCAD file to a specific file. ">ocad_export_file()</a> to export to a file. The options parameter must be binary compatible with OCADExportOptions. </p>

</div>
</div>
<a class="anchor" id="a1c312522ebca751f4df96f3b77a3e9dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_export_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *&#160;</td>
          <td class="paramname"><em>pfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exports part or all of an OCAD file to a specific file. </p>
<p>The "output" field in the options is ignored and will be overwritten by a stream for the provided filename. The options parameter must be binary compatible with OCADExportOptions. </p>

</div>
</div>
<a class="anchor" id="aeca06cf2ff5c7888932c6fa325c53f40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#a0ecf26b576b9a54eca656b9be7ba6a06">bool</a> ocad_file_bounds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OCADRect *&#160;</td>
          <td class="paramname"><em>rect</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the bounding rectangle of all objects in the file. </p>

</div>
</div>
<a class="anchor" id="ac595fc716c3c92481ac5ee141a619514"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_file_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *&#160;</td>
          <td class="paramname"><em>pfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes an open OCADFile. </p>
<p>The memory map is cleared, the file is closed, and all memory buffers used by the object are deallocated. After calling this function, the OCADFile object can be reused by <a class="el" href="libocad_8h.html#aa4c558719d952c795689926f1899a558" title="Opens a file with the given filename. ">ocad_file_open()</a> without causing a memory leak.</p>
<p>Always returns OCAD_OK for success. </p>

</div>
</div>
<a class="anchor" id="ae60bdb2ad0297bb2abf4679d3d6438fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_file_compact </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *&#160;</td>
          <td class="paramname"><em>pfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Optimizes and repairs an open OCADFile. </p>
<p>The file is reordered into Header, Colors, Setup, Symbols, Objects, and Strings. Entities of the same type are brought together into a contiguous section of file and any free space is compacted. The entity indexes are likewise compacted and cached data in the entities and index entries is regenerated, as follows:</p>
<p>Symbols: The "extent" field is recalculated from the symbol properties. </p>
<p>Objects: The bounding rectangle is recalculated from the path and symbol. </p>

</div>
</div>
<a class="anchor" id="a2a5831e0bcdc545ba99487e3728dab2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_file_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> **&#160;</td>
          <td class="paramname"><em>pfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new OCADFile struct in memory. </p>
<p>Unused parts of the file buffer are set to zero.</p>
<p>Returns OCAD_OK on success, or OCAD_OUT_OF_MEMORY. </p>

</div>
</div>
<a class="anchor" id="aa4c558719d952c795689926f1899a558"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_file_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> **&#160;</td>
          <td class="paramname"><em>pfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens a file with the given filename. </p>
<p>The file is loaded into memory and is accessible through the various ocad_file_* methods. The first argument can either be a pointer to a pre-allocated OCADFile object (e.g., on the stack), or NULL to cause the object to be allocated on the heap. In the first case, the preallocated memory is considered to be uninitialized and will be zeroed before opening the file.</p>
<p>This function will verify the magic number and set up the OCAD file version.</p>
<p>An open OCADFile can be closed with <a class="el" href="libocad_8h.html#ac595fc716c3c92481ac5ee141a619514" title="Closes an open OCADFile. ">ocad_file_close()</a>.</p>
<p>Returns OCAD_OK on success, or one of the following error codes:</p><ul>
<li>
OCAD_OUT_OF_MEMORY: Unable to allocate memory. errno was last set by malloc(2). </li>
<li>
OCAD_FILE_WAS_READONLY: Unable to open file in read/write mode. errno was last set by open(2). </li>
<li>
OCAD_MMAP_FAILED: Unable to memory map file. errno was last set by mmap(2) or read(2). </li>
<li>
OCAD_INVALID_FORMAT: Unknown file format. </li>
</ul>

</div>
</div>
<a class="anchor" id="a18982d6416484fe638b1a8031fc688c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_file_open_mapped </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> **&#160;</td>
          <td class="paramname"><em>pfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Behaves exactly like <a class="el" href="libocad_8h.html#aa4c558719d952c795689926f1899a558" title="Opens a file with the given filename. ">ocad_file_open()</a>, except that the system attempts to open the file via memory mapping. </p>
<p>Returns 0 on success, one of the error codes returned by <a class="el" href="libocad_8h.html#aa4c558719d952c795689926f1899a558" title="Opens a file with the given filename. ">ocad_file_open()</a>, or one of the following:</p><ul>
<li>
OCAD_MMAP_NOT_SUPPORTED: Memory mapping is not supported with this combination of system and libraries. </li>
</ul>

</div>
</div>
<a class="anchor" id="a5119d89e1bfc80481f230c28404b1cfb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_file_open_memory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> **&#160;</td>
          <td class="paramname"><em>pfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#a92c50087ca0e64fa93fc59402c55f8ca">u8</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#afaa62991928fb9fb18ff0db62a040aba">u32</a>&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Behaves exactly like <a class="el" href="libocad_8h.html#aa4c558719d952c795689926f1899a558" title="Opens a file with the given filename. ">ocad_file_open()</a>, except that the given buffer must contain the map data. </p>
<p>The buffer must be allocated with malloc(). Ownership of the buffer is transferred to libocad. </p>

</div>
</div>
<a class="anchor" id="ae48115c9b43398bd185434a841629888"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_file_reserve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>amount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Makes sure that 'amount' number of bytes are reserved in the file's buffer in addition to the already used space. </p>
<p>Sets newly reserved memory to zero. Returns OCAD_OK or OCAD_OUT_OF_MEMORY.</p>
<p>WARNING: be extremely careful with this, as it might invalidate pointers to the buffer! </p>

</div>
</div>
<a class="anchor" id="ab25f310ecd5f163207b8c38ee0e57c5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_file_save </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *&#160;</td>
          <td class="paramname"><em>pfile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a084c469f3329a23234299a9422190a26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_file_save_as </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="libocad_8h.html#a89e544f18c7e4831e7506b7f259f69a1">OCADFile</a> *&#160;</td>
          <td class="paramname"><em>pfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves an open OCADFile to the given filename. </p>
<p>Returns 0 on success, or one of the following error codes: -2: Unable to open file for writing errno was last set by open(2). -3: Unable to completely write data to the file. errno was last set by write(2). </p>

</div>
</div>
<a class="anchor" id="aeaf1a64097132d2ec2749c3bfe15facf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the libocad library. </p>
<p>Currently, this only does some checks to determine that the library was compiled correctly and structures are packed appropriately. Returns 0 on success, or exits the current process on failure. </p>

</div>
</div>
<a class="anchor" id="a8af709aad4f892f16448b6bbc334f90b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ocad_shutdown </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shuts down the libocad library. </p>
<p>Currently this is a no-op, but is included as part of the API to support future enhancements. Processes that use the library should call this function when they exit. The function always returns 0 for success. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
